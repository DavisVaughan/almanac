<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a new stepper — stepper • almanac</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a new stepper — stepper"><meta name="description" content="

stepper() returns a function that can be used to add or subtract a
number of days from a Date, &quot;stepping&quot; over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.
workdays() is a convenient stepper for stepping over the weekend.
%s+% steps forwards.
%s-% steps backwards.


You must use %s+ and %s-% to control the stepping. + and - will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call vctrs::vec_arith() directly, which powers %s+% with a correct
double dispatch implementation."><meta property="og:description" content="

stepper() returns a function that can be used to add or subtract a
number of days from a Date, &quot;stepping&quot; over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.
workdays() is a convenient stepper for stepping over the weekend.
%s+% steps forwards.
%s-% steps backwards.


You must use %s+ and %s-% to control the stepping. + and - will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call vctrs::vec_arith() directly, which powers %s+% with a correct
double dispatch implementation."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">almanac</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/almanac.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/adjust-and-shift.html">Adjusting and shifting dates</a></li>
    <li><a class="dropdown-item" href="../articles/holidays-calendars.html">Holidays and calendars</a></li>
    <li><a class="dropdown-item" href="../articles/icalendar.html">iCalendar specification</a></li>
    <li><a class="dropdown-item" href="../articles/quarterly.html">Quarterly rules</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DavisVaughan/almanac/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a new stepper</h1>
      <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/almanac/blob/main/R/stepper.R" class="external-link"><code>R/stepper.R</code></a></small>
      <div class="d-none name"><code>stepper.Rd</code></div>
    </div>

    <div class="ref-description section level2">

<ul><li><p><code>stepper()</code> returns a function that can be used to add or subtract a
number of days from a Date, "stepping" over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.</p></li>
<li><p><code>workdays()</code> is a convenient stepper for stepping over the weekend.</p></li>
<li><p><code>%s+%</code> steps forwards.</p></li>
<li><p><code>%s-%</code> steps backwards.</p></li>
</ul><p>You <em>must</em> use <code>%s+</code> and <code>%s-%</code> to control the stepping. <code>+</code> and <code>-</code> will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call <code><a href="https://vctrs.r-lib.org/reference/vec_arith.html" class="external-link">vctrs::vec_arith()</a></code> directly, which powers <code>%s+%</code> with a correct
double dispatch implementation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stepper</span><span class="op">(</span><span class="va">rschedule</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">%s+%</span> <span class="va">y</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">%s-%</span> <span class="va">y</span></span>
<span></span>
<span><span class="fu">workdays</span><span class="op">(</span><span class="va">n</span>, since <span class="op">=</span> <span class="cn">NULL</span>, until <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-rschedule">rschedule<a class="anchor" aria-label="anchor" href="#arg-rschedule"></a></dt>
<dd><p><code>[rschedule]</code></p>
<p>An rschedule, such as an rrule, runion, rintersect, or rsetdiff.</p></dd>


<dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p><code>[objects]</code></p>
<p>Objects to perform step arithmetic on. Typically Dates or steppers.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p><code>[integer]</code></p>
<p>The number of days to step. Can be negative to step backwards.</p></dd>


<dt id="arg-since">since<a class="anchor" aria-label="anchor" href="#arg-since"></a></dt>
<dd><p><code>[Date(1)]</code></p>
<p>The lower bound on the event set. Depending on the final
recurrence rule, pieces of information from this anchor date might be used
to generate a complete recurrence rule.</p></dd>


<dt id="arg-until">until<a class="anchor" aria-label="anchor" href="#arg-until"></a></dt>
<dd><p><code>[Date(1)]</code></p>
<p>The upper bound on the event set.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><code>stepper()</code> returns a function of 1 argument, <code>n</code>, that can be used to
step by <code>n</code> days, relative to the rschedule.</p></li>
<li><p><code>workdays()</code> return a new stepper object.</p></li>
<li><p><code>%s+%</code> and <code>%s-%</code> return a new shifted Date vector.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Internally, a stepper is just powered by <code><a href="alma_step.html">alma_step()</a></code>, so feel free to
use that directly.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A Thursday and Friday</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1970-01-01"</span>, <span class="st">"1970-01-02"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Thursday is stepped forward 1 working day to Friday,</span></span></span>
<span class="r-in"><span><span class="co"># and then 1 more working day to Monday.</span></span></span>
<span class="r-in"><span><span class="co"># Friday is stepped forward 1 working day to Monday,</span></span></span>
<span class="r-in"><span><span class="co"># and then 1 more working day to Tuesday</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">%s+%</span> <span class="fu">workdays</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1970-01-05" "1970-01-06"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">on_weekends</span> <span class="op">&lt;-</span> <span class="fu"><a href="rrule.html">weekly</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_day_of_week.html">recur_on_weekends</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">on_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="rrule.html">yearly</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_day_of_month.html">recur_on_day_of_month</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_month_of_year.html">recur_on_month_of_year</a></span><span class="op">(</span><span class="st">"Dec"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rb</span> <span class="op">&lt;-</span> <span class="fu"><a href="rset.html">runion</a></span><span class="op">(</span><span class="va">on_weekends</span>, <span class="va">on_christmas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">workday</span> <span class="op">&lt;-</span> <span class="fu">stepper</span><span class="op">(</span><span class="va">rb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Friday before Christmas, which was on a Monday</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2000-12-22"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steps over the weekend and Christmas to the following Tuesday</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas</span> <span class="op">%s+%</span> <span class="fu">workday</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2000-12-26"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Christmas in 2005 was on a Sunday, but your company probably "observed"</span></span></span>
<span class="r-in"><span><span class="co"># it on Monday. So when you are on the Friday before Christmas in 2005,</span></span></span>
<span class="r-in"><span><span class="co"># stepping forward 1 working day should go to Tuesday.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We'll adjust the previous rule for Christmas to roll to the nearest</span></span></span>
<span class="r-in"><span><span class="co"># non-weekend day, if it happened to fall on a weekend.</span></span></span>
<span class="r-in"><span><span class="va">on_observed_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="radjusted.html">radjusted</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">on_christmas</span>,</span></span>
<span class="r-in"><span>  adjust_on <span class="op">=</span> <span class="va">on_weekends</span>,</span></span>
<span class="r-in"><span>  adjustment <span class="op">=</span> <span class="va">adj_nearest</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that the "observed" date for Christmas is the 26th</span></span></span>
<span class="r-in"><span><span class="fu"><a href="alma_search.html">alma_search</a></span><span class="op">(</span><span class="st">"2005-01-01"</span>, <span class="st">"2006-01-01"</span>, <span class="va">on_observed_christmas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2005-12-26"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rset.html">runion</a></span><span class="op">(</span><span class="va">on_weekends</span>, <span class="va">on_observed_christmas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">workday2</span> <span class="op">&lt;-</span> <span class="fu">stepper</span><span class="op">(</span><span class="va">rb2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas_2005</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2005-12-23"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steps over the weekend and the observed Christmas date</span></span></span>
<span class="r-in"><span><span class="co"># of 2005-12-26 to Tuesday the 27th.</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas_2005</span> <span class="op">%s+%</span> <span class="fu">workday2</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2005-12-27"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Davis Vaughan, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

