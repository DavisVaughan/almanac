<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="

stepper() returns a function that can be used to add or subtract a
number of days from a Date, &quot;stepping&quot; over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.
workdays() is a convenient stepper for stepping over the weekend.
%s+% steps forwards.
%s-% steps backwards.


You must use %s+ and %s-% to control the stepping. + and - will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call vctrs::vec_arith() directly, which powers %s+% with a correct
double dispatch implementation."><title>Create a new stepper — stepper • almanac</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a new stepper — stepper"><meta property="og:description" content="

stepper() returns a function that can be used to add or subtract a
number of days from a Date, &quot;stepping&quot; over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.
workdays() is a convenient stepper for stepping over the weekend.
%s+% steps forwards.
%s-% steps backwards.


You must use %s+ and %s-% to control the stepping. + and - will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call vctrs::vec_arith() directly, which powers %s+% with a correct
double dispatch implementation."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">almanac</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/almanac.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/adjust-and-shift.html">Adjusting and shifting dates</a>
    <a class="dropdown-item" href="../articles/icalendar.html">iCalendar specification</a>
    <a class="dropdown-item" href="../articles/quarterly.html">Quarterly rules</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DavisVaughan/almanac/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a new stepper</h1>
      <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/almanac/blob/HEAD/R/stepper.R" class="external-link"><code>R/stepper.R</code></a></small>
      <div class="d-none name"><code>stepper.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    
<ul><li><p><code>stepper()</code> returns a function that can be used to add or subtract a
number of days from a Date, "stepping" over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.</p></li>
<li><p><code>workdays()</code> is a convenient stepper for stepping over the weekend.</p></li>
<li><p><code>%s+%</code> steps forwards.</p></li>
<li><p><code>%s-%</code> steps backwards.</p></li>
</ul><p>You <em>must</em> use <code>%s+</code> and <code>%s-%</code> to control the stepping. <code>+</code> and <code>-</code> will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call <code><a href="https://vctrs.r-lib.org/reference/vec_arith.html" class="external-link">vctrs::vec_arith()</a></code> directly, which powers <code>%s+%</code> with a correct
double dispatch implementation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stepper</span><span class="op">(</span><span class="va">rschedule</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">%s+%</span> <span class="va">y</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">%s-%</span> <span class="va">y</span></span>
<span></span>
<span><span class="fu">workdays</span><span class="op">(</span><span class="va">n</span>, since <span class="op">=</span> <span class="cn">NULL</span>, until <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>rschedule</dt>
<dd><p><code>[rschedule]</code></p>
<p>An rschedule, such as an rrule, runion, rintersect, or rsetdiff.</p></dd>


<dt>x, y</dt>
<dd><p><code>[objects]</code></p>
<p>Objects to perform step arithmetic on. Typically Dates or steppers.</p></dd>


<dt>n</dt>
<dd><p><code>[integer]</code></p>
<p>The number of days to step. Can be negative to step backwards.</p></dd>


<dt>since</dt>
<dd><p><code>[Date(1)]</code></p>
<p>The lower bound on the event set. Depending on the final
recurrence rule, pieces of information from this anchor date might be used
to generate a complete recurrence rule.</p></dd>


<dt>until</dt>
<dd><p><code>[Date(1)]</code></p>
<p>The upper bound on the event set.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<ul><li><p><code>stepper()</code> returns a function of 1 argument, <code>n</code>, that can be used to
step by <code>n</code> days, relative to the rschedule.</p></li>
<li><p><code>workdays()</code> return a new stepper object.</p></li>
<li><p><code>%s+%</code> and <code>%s-%</code> return a new shifted Date vector.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Internally, a stepper is just powered by <code><a href="alma_step.html">alma_step()</a></code>, so feel free to
use that directly.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A Thursday and Friday</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1970-01-01"</span>, <span class="st">"1970-01-02"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Thursday is stepped forward 1 working day to Friday,</span></span></span>
<span class="r-in"><span><span class="co"># and then 1 more working day to Monday.</span></span></span>
<span class="r-in"><span><span class="co"># Friday is stepped forward 1 working day to Monday,</span></span></span>
<span class="r-in"><span><span class="co"># and then 1 more working day to Tuesday</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">%s+%</span> <span class="fu">workdays</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1970-01-05" "1970-01-06"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">on_weekends</span> <span class="op">&lt;-</span> <span class="fu"><a href="rrule.html">weekly</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_day_of_week.html">recur_on_weekends</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">on_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="rrule.html">yearly</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_day_of_month.html">recur_on_day_of_month</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_month_of_year.html">recur_on_month_of_year</a></span><span class="op">(</span><span class="st">"Dec"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rb</span> <span class="op">&lt;-</span> <span class="fu"><a href="rset.html">runion</a></span><span class="op">(</span><span class="va">on_weekends</span>, <span class="va">on_christmas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">workday</span> <span class="op">&lt;-</span> <span class="fu">stepper</span><span class="op">(</span><span class="va">rb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Friday before Christmas, which was on a Monday</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2000-12-22"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steps over the weekend and Christmas to the following Tuesday</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas</span> <span class="op">%s+%</span> <span class="fu">workday</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2000-12-26"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Christmas in 2005 was on a Sunday, but your company probably "observed"</span></span></span>
<span class="r-in"><span><span class="co"># it on Monday. So when you are on the Friday before Christmas in 2005,</span></span></span>
<span class="r-in"><span><span class="co"># stepping forward 1 working day should go to Tuesday.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We'll adjust the previous rule for Christmas to roll to the nearest</span></span></span>
<span class="r-in"><span><span class="co"># non-weekend day, if it happened to fall on a weekend.</span></span></span>
<span class="r-in"><span><span class="va">on_observed_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="radjusted.html">radjusted</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">on_christmas</span>,</span></span>
<span class="r-in"><span>  adjust_on <span class="op">=</span> <span class="va">on_weekends</span>,</span></span>
<span class="r-in"><span>  adjustment <span class="op">=</span> <span class="va">adj_nearest</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that the "observed" date for Christmas is the 26th</span></span></span>
<span class="r-in"><span><span class="fu"><a href="alma_search.html">alma_search</a></span><span class="op">(</span><span class="st">"2005-01-01"</span>, <span class="st">"2006-01-01"</span>, <span class="va">on_observed_christmas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2005-12-26"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rset.html">runion</a></span><span class="op">(</span><span class="va">on_weekends</span>, <span class="va">on_observed_christmas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">workday2</span> <span class="op">&lt;-</span> <span class="fu">stepper</span><span class="op">(</span><span class="va">rb2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas_2005</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2005-12-23"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steps over the weekend and the observed Christmas date</span></span></span>
<span class="r-in"><span><span class="co"># of 2005-12-26 to Tuesday the 27th.</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas_2005</span> <span class="op">%s+%</span> <span class="fu">workday2</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2005-12-27"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Davis Vaughan, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

