<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a new stepper — stepper • almanac</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create a new stepper — stepper"><meta property="og:description" content="

stepper() returns a function that can be used to add or subtract a
number of days from a Date, &quot;stepping&quot; over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.
workdays() is a convenient stepper for stepping over the weekend.
%s+% steps forwards.
%s-% steps backwards.


You must use %s+ and %s-% to control the stepping. + and - will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call vctrs::vec_arith() directly, which powers %s+% with a correct
double dispatch implementation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">almanac</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/almanac.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/adjust-and-shift.html">Adjusting and Shifting Dates</a>
    </li>
    <li>
      <a href="../articles/icalendar.html">iCalendar Specification</a>
    </li>
    <li>
      <a href="../articles/quarterly.html">Quarterly Rules</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DavisVaughan/almanac/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a new stepper</h1>
    <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/almanac/blob/HEAD/R/stepper.R" class="external-link"><code>R/stepper.R</code></a></small>
    <div class="hidden name"><code>stepper.Rd</code></div>
    </div>

    <div class="ref-description">
    
<ul><li><p><code>stepper()</code> returns a function that can be used to add or subtract a
number of days from a Date, "stepping" over events specified by an
rschedule. You supply it the rschedule to step relative to, and then
call the returned function with the number of days to step by.</p></li>
<li><p><code>workdays()</code> is a convenient stepper for stepping over the weekend.</p></li>
<li><p><code>%s+%</code> steps forwards.</p></li>
<li><p><code>%s-%</code> steps backwards.</p></li>
</ul><p>You <em>must</em> use <code>%s+</code> and <code>%s-%</code> to control the stepping. <code>+</code> and <code>-</code> will
not work due to limitations in R's S3 dispatch system. Alternatively, you
can call <code><a href="https://vctrs.r-lib.org/reference/vec_arith.html" class="external-link">vctrs::vec_arith()</a></code> directly, which powers <code>%s+%</code> with a correct
double dispatch implementation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stepper</span><span class="op">(</span><span class="va">rschedule</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">%s+%</span> <span class="va">y</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">%s-%</span> <span class="va">y</span></span>
<span></span>
<span><span class="fu">workdays</span><span class="op">(</span><span class="va">n</span>, since <span class="op">=</span> <span class="st">"1900-01-01"</span>, until <span class="op">=</span> <span class="st">"2100-01-01"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rschedule</dt>
<dd><p><code>[rschedule]</code></p>
<p>An rschedule, such as an rrule or rbundle.</p></dd>


<dt>x, y</dt>
<dd><p><code>[objects]</code></p>
<p>Objects to perform step arithmetic on. Typically Dates or steppers.</p></dd>


<dt>n</dt>
<dd><p><code>[integer]</code></p>
<p>The number of days to step. Can be negative to step backwards.</p></dd>


<dt>since</dt>
<dd><p><code>[Date(1)]</code></p>
<p>The lower bound on the event set. Depending on the final
recurrence rule, pieces of information from this anchor date might be used
to generate a complete recurrence rule.</p></dd>


<dt>until</dt>
<dd><p><code>[Date(1)]</code></p>
<p>The upper bound on the event set.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<ul><li><p><code>stepper()</code> returns a function of 1 argument, <code>n</code>, that can be used to
step by <code>n</code> days, relative to the rschedule.</p></li>
<li><p><code>workdays()</code> return a new stepper object.</p></li>
<li><p><code>%s+%</code> and <code>%s-%</code> return a new shifted Date vector.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Internally, a stepper is just powered by <code><a href="alma_step.html">alma_step()</a></code>, so feel free to
use that directly.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A Thursday and Friday</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1970-01-01"</span>, <span class="st">"1970-01-02"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Thursday is stepped forward 1 working day to Friday,</span></span></span>
<span class="r-in"><span><span class="co"># and then 1 more working day to Monday.</span></span></span>
<span class="r-in"><span><span class="co"># Friday is stepped forward 1 working day to Monday,</span></span></span>
<span class="r-in"><span><span class="co"># and then 1 more working day to Tuesday</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">%s+%</span> <span class="fu">workdays</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1970-01-05" "1970-01-06"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">on_weekends</span> <span class="op">&lt;-</span> <span class="fu"><a href="rrule.html">weekly</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_wday.html">recur_on_weekends</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">on_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="rrule.html">yearly</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_mday.html">recur_on_mday</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="recur_on_ymonth.html">recur_on_ymonth</a></span><span class="op">(</span><span class="st">"Dec"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rb</span> <span class="op">&lt;-</span> <span class="fu"><a href="rbundle-set.html">runion</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="rbundle-add.html">add_rschedule</a></span><span class="op">(</span><span class="va">on_weekends</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="rbundle-add.html">add_rschedule</a></span><span class="op">(</span><span class="va">on_christmas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">workday</span> <span class="op">&lt;-</span> <span class="fu">stepper</span><span class="op">(</span><span class="va">rb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Friday before Christmas, which was on a Monday</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2000-12-22"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steps over the weekend and Christmas to the following Tuesday</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas</span> <span class="op">%s+%</span> <span class="fu">workday</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2000-12-26"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Christmas in 2005 was on a Sunday, but your company probably "observed"</span></span></span>
<span class="r-in"><span><span class="co"># it on Monday. So when you are on the Friday before Christmas in 2005,</span></span></span>
<span class="r-in"><span><span class="co"># stepping forward 1 working day should go to Tuesday.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We'll adjust the previous rule for Christmas to roll to the nearest</span></span></span>
<span class="r-in"><span><span class="co"># non-weekend day, if it happened to fall on a weekend.</span></span></span>
<span class="r-in"><span><span class="va">on_observed_christmas</span> <span class="op">&lt;-</span> <span class="fu"><a href="radjusted.html">radjusted</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">on_christmas</span>,</span></span>
<span class="r-in"><span>  adjust_on <span class="op">=</span> <span class="va">on_weekends</span>,</span></span>
<span class="r-in"><span>  adjustment <span class="op">=</span> <span class="va">adj_nearest</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that the "observed" date for Christmas is the 26th</span></span></span>
<span class="r-in"><span><span class="fu"><a href="alma_search.html">alma_search</a></span><span class="op">(</span><span class="st">"2005-01-01"</span>, <span class="st">"2006-01-01"</span>, <span class="va">on_observed_christmas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2005-12-26"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rbundle-set.html">runion</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="rbundle-add.html">add_rschedule</a></span><span class="op">(</span><span class="va">on_weekends</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="rbundle-add.html">add_rschedule</a></span><span class="op">(</span><span class="va">on_observed_christmas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">workday2</span> <span class="op">&lt;-</span> <span class="fu">stepper</span><span class="op">(</span><span class="va">rb2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas_2005</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2005-12-23"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steps over the weekend and the observed Christmas date</span></span></span>
<span class="r-in"><span><span class="co"># of 2005-12-26 to Tuesday the 27th.</span></span></span>
<span class="r-in"><span><span class="va">friday_before_christmas_2005</span> <span class="op">%s+%</span> <span class="fu">workday2</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2005-12-27"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Davis Vaughan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

